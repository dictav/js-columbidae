{"version":3,"file":"bundle.js","sources":["../src/util.js","../src/sentry.js","../src/main.js"],"sourcesContent":["function hoge(str) {\n  return 'hoge' + str;\n}\n\nfunction piyo(str) {\n  return hoge(str) + 'piyo';\n}\n\nexport function crash(str) {\n  throw new Error(piyo(str));\n}\n\nexport function sendBeacon(url, data) {\n  if ('undefined' !== typeof navigator.sendBeacon) {\n    return navigator.sendBeacon(url, data);\n  }\n\n  var Request = /*@cc_on @if (@_jscript_version < 10) window.XDomainRequest || @end @*/ window.XMLHttpRequest;\n  if ('undefined' === typeof Request) {\n    return flase\n  }\n\n  var xhr = new Request();\n\n  xhr.open(\"POST\", url, true);\n  xhr.send(data);\n\n  return true;\n}\n\nexport function uuidv4() {\n  var crypto = window.crypto || window.msCrypto;\n\n  if (('undefined' !== typeof crypto) && crypto.getRandomValues) {\n    // Use window.crypto API if available\n    var arr = new Uint16Array(8);\n    crypto.getRandomValues(arr);\n\n    // set 4 in byte 7\n    arr[3] = arr[3] & 0xFFF | 0x4000;\n    // set 2 most significant bits of byte 9 to '10'\n    arr[4] = arr[4] & 0x3FFF | 0x8000;\n\n    var pad = function(num) {\n      var v = num.toString(16);\n      while (v.length < 4) {\n        v = '0' + v;\n      }\n      return v;\n    };\n\n    return pad(arr[0]) + pad(arr[1]) + pad(arr[2]) + pad(arr[3]) + pad(arr[4]) +\n      pad(arr[5]) + pad(arr[6]) + pad(arr[7]);\n  } else {\n    // http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/2117523#2117523\n    return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random()*16|0,\n        v = c === 'x' ? r : r&0x3|0x8;\n      return v.toString(16);\n    });\n  }\n}\n\nexport function extractException(err) {\n  var stacktrace = null;\n  if ('string' === typeof err.stack) {\n    stacktrace = parseStack(err.stack);\n  }\n\n  return {\n    type: 'Error',\n    value: err.message,\n    stacktrace: stacktrace\n  };\n}\n\nvar v8regexp = /at(.*) \\(?(.+):(\\d+):(\\d+)/g\nvar ffregexp = /(.*)@(.+):(\\d+):(\\d+)/g\nexport function parseStack(stack) {\n  var frames = [];\n  [v8regexp, ffregexp].forEach(function(r){\n    if (frames.length > 0) {\n      return;\n    }\n\n    var m = null;\n    while((m = r.exec(stack)) != null) {\n      var funcname = m[1].trim();\n      if (funcname.length == 0) {\n        funcname = '?';\n      }\n\n      var filename = m[2];\n      //if (filename.endsWith('.js')) {\n      //  filename = filename + ':' + m[3] + ':' + m[4];\n      //}\n\n      frames.unshift({\n        function: funcname,\n        filename: filename,\n        lineno: parseInt(m[3]),\n        colno: parseInt(m[4])\n      });\n    }\n  })\n\n  if (frames.length == 0) {\n    return null;\n  }\n\n  return { frames: frames };\n}\n","import { extractException, sendBeacon } from './util'\n\nimport { version } from '../package.json'\n\nfunction Sentry(config) {\n  // memo: IE8 @_jscript_version == 5.8, IE10 @_jscript_version == 10\n  // Sentry.io supports https only.\n  // - XDomainRequest can not send to different protocol. \n  // - XMLHttpRequest on Edge v15 can not send to different protocol. \n  /*@cc_on\n  @if (@_jscript_version < 5.8) throw new Error('This library does not support IE8-'); @end\n  @if (@_jscript_version < 10) if (window.location.protocol !== 'https:') throw new Error('Sentry.io supports https only'); @end\n  @*/\n\n  if ('undefined' === typeof config.uuidv4) {\n    throw new Error('uuidv4 is required');\n  }\n\n  this.start = (new Date()).getTime();\n  this.uuidv4 = config.uuidv4;\n  this.sendBeacon = config.sendBeacon;\n  this.url = \"//sentry.io/api/\" + config.projectId + \"/store/\"\n    + \"?sentry_version=7\"\n    + \"&sentry_client=simple-reporter%2F\" + version\n    + \"&sentry_key=\" + config.key;\n  this.payload = {\n    project: config.projectId,\n    logger: 'javascript',\n    platform: 'javascript',\n    request: {\n      headers: {\n        'User-Agent': navigator.userAgent,\n      },\n      url: window.location.href\n    },\n    exception: {\n      values: []\n    },\n    extra: {\n      'session:duration': 0\n    }\n  }\n}\n\nSentry.prototype.send = function(err) {\n  var id = this.uuidv4();\n  this.payload.exception.values.push(extractException(err));\n  this.payload.extra['session:duration'] = (new Date()).getTime() - this.start;\n  this.payload.event_id = id;\n\n  sendBeacon(this.url, JSON.stringify(this.payload))\n  return id;\n}\n\nexport default Sentry;\n","import Sentry from './sentry'\nimport { crash, uuidv4 } from './util'\n\nexport function Crash(str) {\n  crash(str)\n}\n\nexport function HelloSentry(config, msg){\n  config.uuidv4 = uuidv4;\n  var st = new Sentry(config);\n  try {\n    crash(msg)\n  } catch(err) {\n    return st.send(err);\n  }\n}\n"],"names":["hoge","str","piyo","crash","Error","sendBeacon","url","data","navigator","Request","window","XMLHttpRequest","flase","xhr","open","send","uuidv4","crypto","msCrypto","getRandomValues","arr","Uint16Array","pad","num","v","toString","length","replace","c","r","Math","random","extractException","err","stacktrace","stack","parseStack","type","value","message","frames","v8regexp","ffregexp","forEach","m","exec","funcname","trim","filename","unshift","function","lineno","parseInt","colno","Sentry","config","this","start","Date","getTime","projectId","version","key","payload","project","logger","platform","request","headers","User-Agent","userAgent","location","href","exception","values","extra","session:duration","prototype","id","push","event_id","JSON","stringify","msg","st"],"mappings":"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"}